{"version":3,"sources":["../../src/pages/prod-sign/prod-sign.module.ts","../../src/pipes/pipes.module.ts","../../src/pages/prod-sign/prod-sign.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ProdSignPage } from './prod-sign';\nimport { PipesModule } from '../../pipes/pipes.module';\n\n@NgModule({\n  declarations: [\n    ProdSignPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ProdSignPage),\n    PipesModule\n  ],\n  exports: [\n    ProdSignPage\n  ]\n})\nexport class ProdSignPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/prod-sign/prod-sign.module.ts","import { NgModule } from '@angular/core';\nimport { FilterPipe } from './filter/filter';\nimport { MomentFormatPipe } from './moment-format/moment-format';\nimport { FieldFilterPipe } from './field-filter/field-filter';\nimport { SortPipe } from './sort/sort';\nimport { ObjNgforPipe } from './obj-ngfor/obj-ngfor';\n\n@NgModule({\n  declarations: [\n\t  FilterPipe, \n\t  MomentFormatPipe,\n\t  FieldFilterPipe,\n\t  SortPipe,\n\t  ObjNgforPipe,\n  ],\n  exports: [\n\t  FilterPipe,\n\t  MomentFormatPipe,\n\t  FieldFilterPipe,\n\t  SortPipe,\n\t  ObjNgforPipe,\n  ]\n})\nexport class PipesModule {} \n\n\n// WEBPACK FOOTER //\n// ./src/pipes/pipes.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController, Platform} from 'ionic-angular';\n\nimport { StaticDataProvider, ProductionDataProvider } from '../../providers';\nimport { SortPipe } from '../../pipes';\nimport * as moment from 'moment';\n\n@IonicPage()\n@Component({\n  selector: 'page-prod-sign',\n  templateUrl: 'prod-sign.html',\n})\nexport class ProdSignPage {\n\n  prodSubs:any;\n\tproduction: any;\n\tdate = moment();\n\tprodObj: any;\n\tm2total = 0;\n\tmltotal = 0;\n\n  constructor(\n  \tpublic navCtrl: NavController,\n  \tpublic navParams: NavParams,\n    public platform: Platform,\n    public viewCtrl: ViewController,\n    private staticData: StaticDataProvider,\n    private prodData: ProductionDataProvider,\n    private sortPipe: SortPipe\n  ) {\n  }\n\n  ionViewDidLoad() {\n    this.prodData.getProduction().subscribe( prod => {\n  \t\tthis.production = prod;\n      this.fileterProd();\n  \t});\n  }\n\n  ionViewWillUnload() {\n    console.log('willunload');\n    console.log('desuscripcion prod sign');\n    this.prodSubs.unsubscribe();\n  }\n\n  fileterProd() {\n  \tlet month = this.date.format('M');\n  \tthis.prodObj = {};\n  \tthis.m2total = 0;\n\t\tthis.mltotal = 0;\n\n  \tlet filtered: Array<any> = this.production.filter( log => {\n      if ( moment(log.date).format('M') === month &&\n        (log.machine == 'Breton' ||\n        log.machine == 'Lineal' ||\n        log.machine == 'Pasado tablas' ||\n        log.machine == 'Biseladora zocalos' ||\n        log.machine == 'Desmolde' ||\n        log.machine == 'Granalladora' ||\n        log.machine == 'Biseladora')\n        ) {\n        return true;\n      }\n    });\n\n    let filteredSorted = this.sortPipe.transform(filtered, 'date', true, false);\n\n    filteredSorted.forEach( log => {\n    \tlet m2 = 0;\n    \tlet ml = 0;\n  \t\tlet prod = this.toSalesUnit(log.prod, log.dim);\n  \t\tlet date = moment(log.date).format('DD/MM/YYYY');\n\n  \t\tif (this.staticData.equivalences[log.dim].unit === 'm2') {\n  \t\t\tm2 = prod;\n  \t\t\tthis.m2total += prod;\n  \t\t} else {\n  \t\t\tml = prod;\n  \t\t\tthis.mltotal += prod;\n  \t\t}\n\n  \t\tif (!this.prodObj[date]) {\n  \t\t\tthis.prodObj[date] = {\n  \t\t\t\tm2: m2,\n  \t\t\t\tml: ml\n  \t\t\t};\n  \t\t} else {\n  \t\t\tthis.prodObj[date].m2 += m2;\n  \t\t\tthis.prodObj[date].ml += ml;\n  \t\t}\n    })\n    console.log(this.prodObj, this.m2total, this.mltotal);\n\n  }\n\n  toSalesUnit(unit: string, dim) {\n    let eq = this.staticData.equivalences[dim];\n    let total: number = 0\n    let itemN = +unit;\n    total += itemN * eq.conv;\n    return total;\n  }\n\n  premio() {\n  \tif (this.m2total > 5000 ) {\n\t  \treturn (this.m2total - 5000)*this.staticData.premioProd.factorM2 + this.mltotal*this.staticData.premioProd.factorMl\n\t  } else {\n\t  \treturn 0;\n\t  }\n  }\n\n  addMonth() {\n    this.date = moment(this.date).add(1, 'months')\n    this.fileterProd();\n  }\n\n  subMonth() {\n    this.date = moment(this.date).subtract(1, 'months')\n    this.fileterProd();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/prod-sign/prod-sign.ts"],"sourceRoot":""}