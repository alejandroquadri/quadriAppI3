{"version":3,"sources":["../../src/pages/crm-send-psp/crm-send-psp.module.ts","../../src/pipes/pipes.module.ts","../../src/pages/crm-send-psp/crm-send-psp.ts"],"names":[],"mappings":"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","file":"22.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { CrmSendPspPage } from './crm-send-psp';\n\nimport { PipesModule } from '../../pipes/pipes.module';\nimport { ElasticModule } from 'angular2-elastic';\n\n@NgModule({\n  declarations: [\n    CrmSendPspPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(CrmSendPspPage),\n    PipesModule,\n    ElasticModule\n  ],\n})\nexport class CrmSendPspPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/crm-send-psp/crm-send-psp.module.ts","import { NgModule } from '@angular/core';\nimport { FilterPipe } from './filter/filter';\nimport { MomentFormatPipe } from './moment-format/moment-format';\nimport { FieldFilterPipe } from './field-filter/field-filter';\nimport { SortPipe } from './sort/sort';\nimport { ObjNgforPipe } from './obj-ngfor/obj-ngfor';\nimport { CustomCurrencyPipe } from './custom-currency/custom-currency';\n\n@NgModule({\n  declarations: [\n\t  FilterPipe, \n\t  MomentFormatPipe,\n\t  FieldFilterPipe,\n\t  SortPipe,\n\t  ObjNgforPipe,\n    CustomCurrencyPipe,\n  ],\n  exports: [\n\t  FilterPipe,\n\t  MomentFormatPipe,\n\t  FieldFilterPipe,\n\t  SortPipe,\n\t  ObjNgforPipe,\n    CustomCurrencyPipe,\n  ]\n})\nexport class PipesModule {} \n\n\n// WEBPACK FOOTER //\n// ./src/pipes/pipes.module.ts","import { FormBuilder, Validators, FormGroup } from '@angular/forms';\nimport { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ViewController } from 'ionic-angular';\nimport { CrmDataProvider, AuthDataProvider } from '../../providers';\n\nimport { map } from 'rxjs/operators';\nimport 'rxjs/add/operator/toPromise';\n\nimport * as moment from 'moment';\n\n@IonicPage()\n@Component({\n  selector: 'page-crm-send-psp',\n  templateUrl: 'crm-send-psp.html',\n})\nexport class CrmSendPspPage {\n\n  emailForm: FormGroup;\n  psp: any;\n  op: any;\n  currentEmail: string;\n  currentSalesMan: string;\n\n  constructor(\n    public navCtrl: NavController, \n    public navParams: NavParams,\n    public viewCtrl: ViewController,\n    private fb: FormBuilder,\n    private crmData: CrmDataProvider,\n    private authData: AuthDataProvider\n  ) {\n    this.buildForm();\n    this.currentEmail = this.authData.current.email;\n    this.currentSalesMan = this.crmData.currentSalesRep;\n    console.log(this.currentEmail);\n  }\n\n  ionViewDidLoad() {\n    console.log(this.navParams.data.psp, this.navParams.data.op);\n    this.psp = this.navParams.data.psp;\n    this.op = this.navParams.data.op;\n  }\n\n  buildForm() {\n    this.emailForm = this.fb.group({\n      to: ['', [Validators.required, Validators.email]],\n      cc: [''],\n      obs: ['']\n    })\n  }\n\n  onSubmit() {\n    let today = moment().format('YYYY-MM-DD');\n\n    let emailForm = this.emailForm.value;\n    emailForm['date'] = this.psp.date;\n    emailForm['number'] = this.psp.num;\n    emailForm['razSoc'] = this.psp.razSoc;\n    emailForm['salesRep'] = this.psp.salesRep;\n    emailForm['total'] = this.psp.total;\n    emailForm['items'] = this.psp.items;\n    emailForm['currentEmail'] = this.currentEmail;\n    console.log(emailForm);\n\n    let activityForm = {\n      time: today,\n  \t\taction: 'Envio de psp',\n      desc: `Envio presupuesto ${this.psp.num} a ${emailForm.to}`,\n      complete: true,\n      salesRep: this.currentSalesMan\n    }\n\n    if (this.op) {\n      activityForm = this.op;\n      activityForm['time'] = today;\n      activityForm['action'] = 'Envio de psp';\n      activityForm['desc'] = `Envio presupuesto ${this.psp.num} a ${emailForm.to}`;\n      activityForm['complete']  = true;\n    }\n    \n    this.crmData.postPsp(emailForm)\n    .pipe( \n      map( res => res.json())\n    )\n    .toPromise()\n    .then( res => {\n      console.log('mail enviado');\n      this.crmData.newAgendaNote(activityForm)\n    })\n    .then( ret =>  {\n      console.log('activity log cargado', ret);\n      this.viewCtrl.dismiss();\n    })\n    .catch( reason => {\n      console.log('error en envio' , reason)\n    })\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/crm-send-psp/crm-send-psp.ts"],"sourceRoot":""}